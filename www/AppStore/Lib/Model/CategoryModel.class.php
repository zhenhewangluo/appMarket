<?php
/**
 +------------------------------------------------------------------------------
 * @description:	总分类Model
 +------------------------------------------------------------------------------
 * @others:			NULL
 * @file:			CategoryModel.class.php
 * @author:		xuhao
 * @date:			2011-12-08
 +------------------------------------------------------------------------------
 */
class CategoryModel extends Model
{
	public $_msg = '';  //调试使用返回错误信息
	protected $dbName = '_v2_android';//指定数据库名称
	/**
     +----------------------------------------------------------
     * 获取所有app分类信息
     +----------------------------------------------------------
     * @access public
     +----------------------------------------------------------
     * @param string $order 排序的字段
     +----------------------------------------------------------
     * @return mixed
     +----------------------------------------------------------
	 * @date:			2011-12-8
     +----------------------------------------------------------
	 * @author:		xuhao
     +----------------------------------------------------------
     */	
	public function getCategorys($order = '`order` ASC')
	{
		return $this->order($order)->findall();
	}
	/**
     +----------------------------------------------------------
     * 获取分类树
     +----------------------------------------------------------
     * @access public
     +----------------------------------------------------------
     * @return array
     +----------------------------------------------------------
	 * @date:			2011-12-8
     +----------------------------------------------------------
	 * @author:		xuhao
     +----------------------------------------------------------
     */	
	public function getCateTree()
	{
		$appCateRow = $this->getCategorys('`order` DESC'); //查找所有分类信息
		Load('extend');//载入函数扩展
		return list_sort_by(list_to_tree($appCateRow, 'id', 'parent_id', '_child', 0), 'order');//数组转树并排序
	}
	/**
     +----------------------------------------------------------
     * 根据分类id获取应用当前分类信息
     +----------------------------------------------------------
     * @access public
     +----------------------------------------------------------
     * @param int $aid 应用id
	 * @param string $fields 需要取的字段
     +----------------------------------------------------------
     * @return mixed
     +----------------------------------------------------------
	 * @date:			2011-12-8
     +----------------------------------------------------------
	 * @author:		xuhao
     +----------------------------------------------------------
     */
	public function getCateInfoByCid($cid, $fields = 'id, name, description')
	{
		return $this->field($fields)->where("id = {$cid}")->find();
	}
}
?>
